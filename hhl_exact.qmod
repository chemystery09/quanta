qfunc load_b(amplitudes: real[], output state: qbit[], bound: real) {
  prepare_amplitudes(amplitudes, bound, state);
}

qfunc simple_eig_inv(phase: qnum, output indicator: qbit) {
  allocate(1, indicator);
  indicator *= (1 / (2 ** phase.size)) / phase;
}

qfunc hhl(rhs_vector: real[], bound: real, precision: int, hamiltonian_evolution_with_power: qfunc (int, qbit[]), output state: qbit[], output phase: qnum, output indicator: qbit) {
  allocate_num(precision, False, precision, phase);
  load_b([
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    (-1.0),
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ], state, bound);
  within {
    qpe_flexible(lambda(k) {
      hamiltonian_evolution_with_power(k, state);
    }, phase);
  } apply {
    simple_eig_inv(phase, indicator);
  }
}

qfunc unitary_with_power_logic(pw: int, matrix: real[][], target: qbit[]) {
  power (pw) {
    unitary(matrix, target);
  }
}

qfunc main(output res: qnum, output phase: qnum, output indicator: qbit) {
  hhl([
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    (-1.0),
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0,
    0.0
  ], 0, 4, lambda(arg0, arg1) {
    unitary_with_power_logic(arg0, [
      [
        ((-0.4315330427190747) - 0.29291283286522385j),
        ((-0.25777045664587334) + 0.37975963153059167j),
        (0.15713099373137457 + 0.1066562231591314j),
        (0.029753613973249726 - 0.04383443171188435j),
        ((-0.2577704566458734) + 0.379759631530592j),
        (0.33419776347030605 + 0.22684430610111012j),
        (0.09386008485501758 - 0.13827911741235688j),
        ((-0.03857537195846873) - 0.026183907976058508j),
        (0.15713099373137457 + 0.10665622315913136j),
        (0.09386008485501754 - 0.13827911741235682j),
        ((-0.05721496790938071) - 0.03883595616926965j),
        ((-0.010833967432153226) + 0.015961113362580548j),
        (0.02975361397324973 - 0.04383443171188439j),
        ((-0.038575371958468746) - 0.026183907976058508j),
        ((-0.01083396743215323) + 0.015961113362580555j),
        (0.00445263099992718 + 0.0030223242041310626j)
      ],
      [
        ((-0.2577704566458733) + 0.37975963153059183j),
        ((-0.27440204898770043) - 0.18625660970609198j),
        ((-0.22801684267262365) + 0.3359251998187076j),
        (0.1571309937313746 + 0.10665622315913131j),
        (0.33419776347030616 + 0.22684430610111006j),
        ((-0.16391037179085582) + 0.2414805141182353j),
        (0.29562239151183756 + 0.20066039812505163j),
        (0.09386008485501758 - 0.1382791174123569j),
        (0.09386008485501754 - 0.13827911741235688j),
        (0.09991602582199396 + 0.06782026698986167j),
        (0.0830261174228644 - 0.12231800404977633j),
        ((-0.05721496790938072) - 0.03883595616926964j),
        ((-0.038575371958468746) - 0.026183907976058508j),
        (0.0189196465410965 - 0.02787331834930384j),
        ((-0.03412274095854158) - 0.02316158377192746j),
        ((-0.010833967432153221) + 0.015961113362580548j)
      ],
      [
        (0.15713099373137457 + 0.1066562231591314j),
        ((-0.22801684267262365) + 0.3359251998187076j),
        ((-0.2744020489877003) - 0.1862566097060927j),
        ((-0.2577704566458734) + 0.379759631530592j),
        (0.09386008485501761 - 0.13827911741235688j),
        (0.2956223915118375 + 0.20066039812505174j),
        ((-0.16391037179085588) + 0.24148051411823512j),
        (0.33419776347030616 + 0.22684430610111017j),
        ((-0.05721496790938074) - 0.038835956169269645j),
        (0.0830261174228644 - 0.12231800404977633j),
        (0.09991602582199398 + 0.06782026698986178j),
        (0.09386008485501761 - 0.1382791174123569j),
        ((-0.010833967432153232) + 0.015961113362580555j),
        ((-0.03412274095854157) - 0.023161583771927466j),
        (0.018919646541096534 - 0.027873318349303847j),
        ((-0.03857537195846873) - 0.02618390797605851j)
      ],
      [
        (0.02975361397324973 - 0.04383443171188437j),
        (0.1571309937313746 + 0.10665622315913136j),
        ((-0.25777045664587345) + 0.37975963153059195j),
        ((-0.43153304271907506) - 0.2929128328652232j),
        ((-0.03857537195846874) - 0.02618390797605851j),
        (0.09386008485501758 - 0.13827911741235685j),
        (0.33419776347030616 + 0.22684430610111j),
        ((-0.25777045664587345) + 0.3797596315305921j),
        ((-0.010833967432153225) + 0.015961113362580555j),
        ((-0.05721496790938073) - 0.03883595616926964j),
        (0.09386008485501758 - 0.13827911741235688j),
        (0.1571309937313747 + 0.10665622315913134j),
        (0.00445263099992718 + 0.0030223242041310626j),
        ((-0.010833967432153225) + 0.015961113362580555j),
        ((-0.038575371958468746) - 0.02618390797605851j),
        (0.0297536139732497 - 0.043834431711884364j)
      ],
      [
        ((-0.2577704566458734) + 0.379759631530592j),
        (0.33419776347030616 + 0.22684430610111j),
        (0.09386008485501758 - 0.13827911741235688j),
        ((-0.038575371958468746) - 0.026183907976058508j),
        ((-0.27440204898770054) - 0.18625660970609237j),
        ((-0.16391037179085582) + 0.2414805141182353j),
        (0.09991602582199398 + 0.06782026698986168j),
        (0.01891964654109651 - 0.027873318349303858j),
        ((-0.22801684267262362) + 0.3359251998187076j),
        (0.29562239151183745 + 0.20066039812505163j),
        (0.08302611742286439 - 0.12231800404977633j),
        ((-0.03412274095854158) - 0.02316158377192745j),
        (0.15713099373137474 + 0.10665622315913136j),
        (0.09386008485501758 - 0.1382791174123569j),
        ((-0.05721496790938075) - 0.03883595616926967j),
        ((-0.010833967432153225) + 0.015961113362580555j)
      ],
      [
        (0.33419776347030616 + 0.2268443061011101j),
        ((-0.16391037179085574) + 0.2414805141182352j),
        (0.2956223915118375 + 0.20066039812505165j),
        (0.09386008485501758 - 0.13827911741235693j),
        ((-0.16391037179085588) + 0.2414805141182353j),
        ((-0.1744860231657066) - 0.11843634271623078j),
        ((-0.1449907252497592) + 0.21360719576893142j),
        (0.09991602582199402 + 0.06782026698986175j),
        (0.29562239151183745 + 0.20066039812505157j),
        ((-0.14499072524975926) + 0.21360719576893125j),
        (0.26149965055329594 + 0.1774988143531242j),
        (0.08302611742286437 - 0.12231800404977636j),
        (0.09386008485501758 - 0.13827911741235688j),
        (0.09991602582199394 + 0.06782026698986168j),
        (0.08302611742286439 - 0.12231800404977636j),
        ((-0.05721496790938073) - 0.038835956169269645j)
      ],
      [
        (0.09386008485501758 - 0.13827911741235685j),
        (0.29562239151183745 + 0.20066039812505163j),
        ((-0.16391037179085585) + 0.24148051411823512j),
        (0.33419776347030616 + 0.22684430610111006j),
        (0.09991602582199394 + 0.06782026698986168j),
        ((-0.14499072524975914) + 0.2136071957689312j),
        ((-0.1744860231657065) - 0.11843634271623031j),
        ((-0.16391037179085585) + 0.24148051411823518j),
        (0.08302611742286434 - 0.12231800404977632j),
        (0.2614996505532958 + 0.1774988143531241j),
        ((-0.1449907252497594) + 0.21360719576893145j),
        (0.29562239151183745 + 0.20066039812505165j),
        ((-0.05721496790938073) - 0.03883595616926966j),
        (0.08302611742286437 - 0.12231800404977633j),
        (0.09991602582199405 + 0.06782026698986177j),
        (0.09386008485501758 - 0.13827911741235688j)
      ],
      [
        ((-0.03857537195846873) - 0.026183907976058508j),
        (0.09386008485501754 - 0.13827911741235688j),
        (0.33419776347030605 + 0.22684430610111012j),
        ((-0.2577704566458734) + 0.3797596315305921j),
        (0.018919646541096503 - 0.02787331834930383j),
        (0.09991602582199396 + 0.0678202669898617j),
        ((-0.1639103717908557) + 0.24148051411823518j),
        ((-0.2744020489877004) - 0.18625660970609262j),
        ((-0.034122740958541564) - 0.023161583771927438j),
        (0.08302611742286434 - 0.12231800404977633j),
        (0.2956223915118374 + 0.20066039812505163j),
        ((-0.22801684267262365) + 0.3359251998187075j),
        ((-0.010833967432153223) + 0.015961113362580548j),
        ((-0.05721496790938071) - 0.038835956169269645j),
        (0.09386008485501758 - 0.13827911741235682j),
        (0.15713099373137457 + 0.10665622315913129j)
      ],
      [
        (0.15713099373137457 + 0.10665622315913131j),
        (0.09386008485501754 - 0.13827911741235688j),
        ((-0.05721496790938073) - 0.03883595616926963j),
        ((-0.010833967432153226) + 0.015961113362580555j),
        ((-0.22801684267262362) + 0.33592519981870755j),
        (0.29562239151183745 + 0.20066039812505163j),
        (0.08302611742286437 - 0.12231800404977633j),
        ((-0.034122740958541564) - 0.02316158377192746j),
        ((-0.27440204898770026) - 0.18625660970609226j),
        ((-0.1639103717908559) + 0.24148051411823507j),
        (0.09991602582199398 + 0.06782026698986174j),
        (0.01891964654109652 - 0.027873318349303844j),
        ((-0.25777045664587345) + 0.37975963153059195j),
        (0.33419776347030605 + 0.22684430610111012j),
        (0.09386008485501764 - 0.13827911741235688j),
        ((-0.038575371958468746) - 0.02618390797605852j)
      ],
      [
        (0.09386008485501751 - 0.13827911741235688j),
        (0.09991602582199394 + 0.06782026698986168j),
        (0.08302611742286438 - 0.12231800404977632j),
        ((-0.05721496790938073) - 0.038835956169269645j),
        (0.29562239151183745 + 0.20066039812505157j),
        ((-0.14499072524975926) + 0.2136071957689312j),
        (0.2614996505532959 + 0.17749881435312412j),
        (0.08302611742286438 - 0.12231800404977632j),
        ((-0.16391037179085577) + 0.24148051411823498j),
        ((-0.17448602316570638) - 0.11843634271623063j),
        ((-0.14499072524975942) + 0.21360719576893128j),
        (0.09991602582199398 + 0.06782026698986175j),
        (0.33419776347030605 + 0.22684430610111006j),
        ((-0.16391037179085577) + 0.24148051411823507j),
        (0.29562239151183733 + 0.2006603981250517j),
        (0.0938600848550176 - 0.13827911741235685j)
      ],
      [
        ((-0.05721496790938073) - 0.03883595616926963j),
        (0.08302611742286437 - 0.12231800404977632j),
        (0.099916025821994 + 0.0678202669898618j),
        (0.0938600848550176 - 0.13827911741235693j),
        (0.08302611742286437 - 0.12231800404977633j),
        (0.2614996505532958 + 0.17749881435312415j),
        ((-0.14499072524975942) + 0.21360719576893145j),
        (0.29562239151183745 + 0.20066039812505174j),
        (0.09991602582199396 + 0.06782026698986171j),
        ((-0.14499072524975937) + 0.21360719576893125j),
        ((-0.1744860231657065) - 0.11843634271623091j),
        ((-0.16391037179085594) + 0.2414805141182353j),
        (0.0938600848550176 - 0.13827911741235688j),
        (0.29562239151183745 + 0.2006603981250517j),
        ((-0.16391037179085605) + 0.24148051411823526j),
        (0.33419776347030616 + 0.22684430610111012j)
      ],
      [
        ((-0.010833967432153223) + 0.015961113362580548j),
        ((-0.05721496790938069) - 0.03883595616926963j),
        (0.09386008485501758 - 0.13827911741235677j),
        (0.15713099373137457 + 0.10665622315913131j),
        ((-0.03412274095854155) - 0.023161583771927445j),
        (0.08302611742286432 - 0.12231800404977632j),
        (0.29562239151183733 + 0.20066039812505154j),
        ((-0.2280168426726238) + 0.33592519981870733j),
        (0.018919646541096506 - 0.02787331834930382j),
        (0.0999160258219939 + 0.06782026698986171j),
        ((-0.1639103717908559) + 0.24148051411823507j),
        ((-0.2744020489877003) - 0.18625660970609229j),
        ((-0.03857537195846873) - 0.02618390797605851j),
        (0.09386008485501758 - 0.13827911741235682j),
        (0.33419776347030605 + 0.22684430610111012j),
        ((-0.25777045664587317) + 0.37975963153059183j)
      ],
      [
        (0.02975361397324971 - 0.04383443171188438j),
        ((-0.038575371958468746) - 0.0261839079760585j),
        ((-0.010833967432153225) + 0.015961113362580555j),
        (0.004452630999927182 + 0.0030223242041310626j),
        (0.15713099373137468 + 0.10665622315913136j),
        (0.09386008485501758 - 0.1382791174123569j),
        ((-0.05721496790938074) - 0.038835956169269645j),
        ((-0.010833967432153226) + 0.015961113362580555j),
        ((-0.2577704566458734) + 0.379759631530592j),
        (0.33419776347030616 + 0.22684430610111006j),
        (0.0938600848550176 - 0.13827911741235688j),
        ((-0.038575371958468746) - 0.026183907976058518j),
        ((-0.4315330427190754) - 0.2929128328652237j),
        ((-0.25777045664587356) + 0.37975963153059195j),
        (0.15713099373137468 + 0.10665622315913144j),
        (0.029753613973249746 - 0.04383443171188439j)
      ],
      [
        ((-0.038575371958468746) - 0.026183907976058497j),
        (0.018919646541096503 - 0.02787331834930383j),
        ((-0.034122740958541564) - 0.02316158377192745j),
        ((-0.010833967432153226) + 0.015961113362580555j),
        (0.09386008485501758 - 0.1382791174123569j),
        (0.09991602582199394 + 0.06782026698986171j),
        (0.08302611742286437 - 0.12231800404977636j),
        ((-0.05721496790938071) - 0.03883595616926966j),
        (0.3341977634703061 + 0.22684430610111012j),
        ((-0.1639103717908557) + 0.2414805141182351j),
        (0.29562239151183733 + 0.2006603981250517j),
        (0.0938600848550176 - 0.13827911741235685j),
        ((-0.2577704566458735) + 0.379759631530592j),
        ((-0.27440204898770043) - 0.18625660970609254j),
        ((-0.22801684267262395) + 0.3359251998187076j),
        (0.15713099373137468 + 0.10665622315913142j)
      ],
      [
        ((-0.010833967432153223) + 0.015961113362580555j),
        ((-0.03412274095854156) - 0.02316158377192745j),
        (0.018919646541096534 - 0.027873318349303833j),
        ((-0.03857537195846873) - 0.02618390797605851j),
        ((-0.05721496790938072) - 0.03883595616926966j),
        (0.08302611742286437 - 0.12231800404977632j),
        (0.09991602582199398 + 0.0678202669898618j),
        (0.09386008485501761 - 0.13827911741235682j),
        (0.09386008485501761 - 0.13827911741235682j),
        (0.29562239151183733 + 0.20066039812505163j),
        ((-0.16391037179085602) + 0.24148051411823507j),
        (0.33419776347030605 + 0.22684430610111006j),
        (0.15713099373137468 + 0.10665622315913142j),
        ((-0.2280168426726239) + 0.33592519981870766j),
        ((-0.27440204898770054) - 0.1862566097060926j),
        ((-0.2577704566458734) + 0.379759631530592j)
      ],
      [
        (0.00445263099992718 + 0.0030223242041310604j),
        ((-0.010833967432153218) + 0.015961113362580548j),
        ((-0.038575371958468725) - 0.026183907976058508j),
        (0.029753613973249694 - 0.04383443171188435j),
        ((-0.01083396743215322) + 0.015961113362580548j),
        ((-0.0572149679093807) - 0.03883595616926963j),
        (0.09386008485501754 - 0.13827911741235688j),
        (0.15713099373137462 + 0.10665622315913129j),
        ((-0.03857537195846874) - 0.026183907976058518j),
        (0.09386008485501754 - 0.13827911741235685j),
        (0.33419776347030605 + 0.22684430610111006j),
        ((-0.2577704566458731) + 0.37975963153059183j),
        (0.029753613973249736 - 0.04383443171188438j),
        (0.15713099373137468 + 0.10665622315913142j),
        ((-0.2577704566458735) + 0.379759631530592j),
        ((-0.4315330427190752) - 0.2929128328652233j)
      ]
    ], arg1);
  }, res, phase, indicator);
}
